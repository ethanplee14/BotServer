"use strict";function accountScript(){styleMaterialize(),$(".datepicker").datepicker({container:"body"}),registerAccountContextMenu(),registerAddAcc(),registerDelAcc(),registerEditAcc()}$(function(){M.AutoInit();var t={accountScript:accountScript},e=$("body").attr("id");e in t&&t[e]()});var months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function formatDate(t){return t=_normalize(t),"".concat(months[t.getMonth()]," ").concat(t.getDate(),", ").concat(t.getFullYear())}function formatTime(t){var e="";return e+=doubleDigit((t=_normalize(t)).getHours())+":",e+=doubleDigit(t.getMinutes())+":",e+=doubleDigit(t.getSeconds())}function formatDateTime(t){return formatTime(t=_normalize(t))+" "+formatDate(t)}function _normalize(t){return t instanceof Date?t:new Date(t)}function doubleDigit(t){return t<10?"0"+t.toString():t.toString()}function registerAccountContextMenu(){var t=new ContextMenu($(".context-menu"),{add:function(){return $("#add-modal").modal("open")},del:function(){return $("#del-modal").modal("open")},show:function(){updateShowModal(),$("#show-modal").modal("open")}});t.addHook(addSelName),$("#accounts-table>tbody>tr").contextmenu(t.handler)}function addSelName(t){var e=$(this).find("td").first().html();$(".sel-item").html(e)}function registerAddAcc(){$("#add-form").submit(function(t){t.preventDefault(),$.post("account/create",$(this).serialize(),function(t){"success"==t?location.reload():alert("Error adding account")})})}function registerDelAcc(){$("#del-acc").click(function(){var t=$(".sel-item").html();$.ajax({url:"/account/delete",type:"DELETE",data:{name:t},success:function(){return location.reload()}})})}function registerEditAcc(){$("#edit-btn").click(_editMode)}function _editMode(){_registerSubmit(),$("#edit-btn").addClass("scale-out"),$("#submit-row").addClass("scale-in"),$("#update-form [disabled]:not('#show-id, #show-status-change')").removeAttr("disabled")}function _registerSubmit(){$("#update-form").submit(function(t){t.preventDefault(),$.post("account/update",$(this).serialize(),function(t){"success"==t?location.reload():alert("Error adding account")})})}function _registerCancel(){$()}function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(t,e){var n=[],o=!0,a=!1,r=void 0;try{for(var i,c=t[Symbol.iterator]();!(o=(i=c.next()).done)&&(n.push(i.value),!e||n.length!==e);o=!0);}catch(t){a=!0,r=t}finally{try{o||null==c.return||c.return()}finally{if(a)throw r}}return n}function _arrayWithHoles(t){if(Array.isArray(t))return t}var fieldsMapping={"show-id":"_id","show-name":"name","show-email":"email","show-password":"password","show-status":"status","show-pin":"pin","show-created":{prop:"created",parse:formatDate},"show-memb":{prop:"memb",parse:formatDate},"show-status-change":{prop:"lastStatusChange",parse:formatDateTime},"show-break":{prop:"breakUntil",parse:formatDateTime}};function updateShowModal(){var t=$(".sel-item").html();$.get("/account/read",{name:t},populateShowModal)}function populateShowModal(t){for(var e=Object.entries(fieldsMapping),n=0;n<e.length;n++){var o=_slicedToArray(e[n],2),a=o[0],r=o[1],i=void 0;r instanceof Object&&t[r.prop]&&void 0!==r.parse&&(i=r.parse(t[r.prop])),$("#".concat(a)).val(i||t[r]||t[r.prop]||"")}M.updateTextFields(),$("#show-stocked").attr("checked",t.stocked)}function styleMaterialize(){$(".select-dropdown").css("font-size","13px"),$(".display-field").css("color","black")}function ContextMenu(n,e){var o=[];$(document).mousedown(function(t){$.contains(n[0],$(t.target)[0])||$(".context-menu").hide()}),n.children("li").click(function(){var t=$(this).attr("data-action");e[t].call(this),n.hide()}),this.addHook=function(t){o.push(t)},this.handler=function(t){t.preventDefault();for(var e=0;e<o.length;e++){o[e].bind(this)()}n.toggle().css({top:t.pageY-15+"px",left:t.pageX+"px"})}}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFjY291bnQtc2NyaXB0LmpzIiwibWFpbi5qcyIsInBhcnNlcnMvZGF0ZS5qcyIsInJlZ2lzdGVycy9hY2MtY29udGV4dG1lbnUuanMiLCJyZWdpc3RlcnMvYWRkLWFjYy5qcyIsInJlZ2lzdGVycy9kZWwtYWNjLmpzIiwicmVnaXN0ZXJzL2VkaXQtYWNjLmpzIiwicmVnaXN0ZXJzL3Nob3ctYWNjLmpzIiwic3R5bGVycy9tYXRlcmlhbGl6ZS5qcyIsImNvbnRleHRtZW51cy9jb250ZXh0bWVudS5qcyJdLCJuYW1lcyI6WyJhY2NvdW50U2NyaXB0Iiwic3R5bGVNYXRlcmlhbGl6ZSIsIiQiLCJkYXRlcGlja2VyIiwiY29udGFpbmVyIiwicmVnaXN0ZXJBY2NvdW50Q29udGV4dE1lbnUiLCJyZWdpc3RlckFkZEFjYyIsInJlZ2lzdGVyRGVsQWNjIiwicmVnaXN0ZXJFZGl0QWNjIiwiTSIsIkF1dG9Jbml0Iiwicm91dGVzIiwicm91dGUiLCJhdHRyIiwibW9udGhzIiwiZm9ybWF0RGF0ZSIsImRhdGUiLCJfbm9ybWFsaXplIiwiY29uY2F0IiwiZ2V0TW9udGgiLCJnZXREYXRlIiwiZ2V0RnVsbFllYXIiLCJmb3JtYXRUaW1lIiwiZm9ybWF0dGVkVGltZSIsImRvdWJsZURpZ2l0IiwiZ2V0SG91cnMiLCJnZXRNaW51dGVzIiwiZ2V0U2Vjb25kcyIsImZvcm1hdERhdGVUaW1lIiwiRGF0ZSIsIm51bWIiLCJ0b1N0cmluZyIsIm1lbnUiLCJDb250ZXh0TWVudSIsImFkZCIsIm1vZGFsIiwiZGVsIiwic2hvdyIsInVwZGF0ZVNob3dNb2RhbCIsImFkZEhvb2siLCJhZGRTZWxOYW1lIiwiY29udGV4dG1lbnUiLCJoYW5kbGVyIiwicm93TmFtZSIsInRoaXMiLCJmaW5kIiwiZmlyc3QiLCJodG1sIiwic3VibWl0IiwiZSIsInByZXZlbnREZWZhdWx0IiwicG9zdCIsInNlcmlhbGl6ZSIsImRhdGEiLCJsb2NhdGlvbiIsInJlbG9hZCIsImFsZXJ0IiwiY2xpY2siLCJhY2NvdW50TmFtZSIsImFqYXgiLCJ1cmwiLCJ0eXBlIiwibmFtZSIsInN1Y2Nlc3MiLCJfZWRpdE1vZGUiLCJfcmVnaXN0ZXJTdWJtaXQiLCJhZGRDbGFzcyIsInJlbW92ZUF0dHIiLCJfcmVnaXN0ZXJDYW5jZWwiLCJmaWVsZHNNYXBwaW5nIiwic2hvdy1pZCIsInNob3ctbmFtZSIsInNob3ctZW1haWwiLCJzaG93LXBhc3N3b3JkIiwic2hvdy1zdGF0dXMiLCJzaG93LXBpbiIsInNob3ctY3JlYXRlZCIsInByb3AiLCJwYXJzZSIsInNob3ctbWVtYiIsInNob3ctc3RhdHVzLWNoYW5nZSIsInNob3ctYnJlYWsiLCJhY2NOYW1lIiwiZ2V0IiwicG9wdWxhdGVTaG93TW9kYWwiLCJhY2MiLCJfYXJyIiwiT2JqZWN0IiwiZW50cmllcyIsIl9pIiwibGVuZ3RoIiwiX2FyciRfaSIsIl9zbGljZWRUb0FycmF5Iiwia2V5IiwidmFsIiwibmV3VmFsIiwidW5kZWZpbmVkIiwidXBkYXRlVGV4dEZpZWxkcyIsImNzcyIsImNvbnRleHRNZW51Iiwib3B0aW9ucyIsIm1lbnVPcGVuSG9va3MiLCJkb2N1bWVudCIsIm1vdXNlZG93biIsImNvbnRhaW5zIiwidGFyZ2V0IiwiaGlkZSIsImNoaWxkcmVuIiwiYWN0aW9uIiwiY2FsbCIsImhvb2siLCJwdXNoIiwiYmluZCIsInRvZ2dsZSIsInRvcCIsInBhZ2VZIiwibGVmdCIsInBhZ2VYIl0sIm1hcHBpbmdzIjoiYUFDQSxTQUFTQSxnQkFDTEMsbUJBQ0FDLEVBQUUsZUFBZUMsV0FBVyxDQUN4QkMsVUFBVyxTQUVmQyw2QkFDQUMsaUJBQ0FDLGlCQUNBQyxrQkNSSk4sRUFBRSxXQUNFTyxFQUFFQyxXQUNGLElBQUlDLEVBQVMsQ0FDVFgsY0FBaUJBLGVBRWpCWSxFQUFRVixFQUFFLFFBQVFXLEtBQUssTUFFeEJELEtBQVNELEdBQ1JBLEVBQU9DLE9DUmYsSUFBTUUsT0FBUyxDQUFDLE1BQU0sTUFBTSxNQUFNLE1BQU0sTUFBTSxNQUFNLE1BQU0sTUFBTSxNQUFNLE1BQU0sTUFBTSxPQUVsRixTQUFTQyxXQUFXQyxHQUVoQixPQURBQSxFQUFPQyxXQUFXRCxHQUNsQixHQUFBRSxPQUFVSixPQUFPRSxFQUFLRyxZQUF0QixLQUFBRCxPQUFxQ0YsRUFBS0ksVUFBMUMsTUFBQUYsT0FBd0RGLEVBQUtLLGVBR2pFLFNBQVNDLFdBQVdOLEdBRWhCLElBQUlPLEVBQWdCLEdBSXBCLE9BSEFBLEdBQWlCQyxhQUZqQlIsRUFBT0MsV0FBV0QsSUFFZ0JTLFlBQWMsSUFDaERGLEdBQWlCQyxZQUFZUixFQUFLVSxjQUFnQixJQUNsREgsR0FBaUJDLFlBQVlSLEVBQUtXLGNBSXRDLFNBQVNDLGVBQWVaLEdBRXBCLE9BQU9NLFdBRFBOLEVBQU9DLFdBQVdELElBQ1EsSUFBTUQsV0FBV0MsR0FHL0MsU0FBU0MsV0FBV0QsR0FDaEIsT0FBUUEsYUFBZ0JhLEtBQVFiLEVBQU8sSUFBSWEsS0FBS2IsR0FHcEQsU0FBU1EsWUFBWU0sR0FDakIsT0FBR0EsRUFBTyxHQUNDLElBQU1BLEVBQUtDLFdBQ2ZELEVBQUtDLFdDNUJoQixTQUFTMUIsNkJBQ0wsSUFBSTJCLEVBQU8sSUFBSUMsWUFBWS9CLEVBQUUsaUJBQWtCLENBQzNDZ0MsSUFBTyxXQUFBLE9BQU1oQyxFQUFFLGNBQWNpQyxNQUFNLFNBQ25DQyxJQUFPLFdBQUEsT0FBTWxDLEVBQUUsY0FBY2lDLE1BQU0sU0FDbkNFLEtBQVEsV0FDSkMsa0JBQ0FwQyxFQUFFLGVBQWVpQyxNQUFNLFdBRy9CSCxFQUFLTyxRQUFRQyxZQUNidEMsRUFBRSw0QkFBNEJ1QyxZQUFZVCxFQUFLVSxTQUduRCxTQUFTRixXQUFXUixHQUNoQixJQUFJVyxFQUFVekMsRUFBRTBDLE1BQU1DLEtBQUssTUFBTUMsUUFBUUMsT0FDekM3QyxFQUFFLGFBQWE2QyxLQUFLSixHQ2hCeEIsU0FBU3JDLGlCQUNMSixFQUFFLGFBQWE4QyxPQUFPLFNBQVVDLEdBQzVCQSxFQUFFQyxpQkFDRmhELEVBQUVpRCxLQUFLLGlCQUFrQmpELEVBQUUwQyxNQUFNUSxZQUFhLFNBQVNDLEdBQ3ZDLFdBQVJBLEVBQ0FDLFNBQVNDLFNBRVRDLE1BQU0sNEJDTnRCLFNBQVNqRCxpQkFDTEwsRUFBRSxZQUFZdUQsTUFBTSxXQUNoQixJQUFJQyxFQUFjeEQsRUFBRSxhQUFhNkMsT0FDakM3QyxFQUFFeUQsS0FBSyxDQUNIQyxJQUFPLGtCQUNQQyxLQUFRLFNBQ1JSLEtBQVEsQ0FBQ1MsS0FBTUosR0FDZkssUUFBUyxXQUFBLE9BQU1ULFNBQVNDLGNDUHBDLFNBQVMvQyxrQkFDTE4sRUFBRSxhQUFhdUQsTUFBTU8sV0FHekIsU0FBU0EsWUFDTEMsa0JBQ0EvRCxFQUFFLGFBQWFnRSxTQUFTLGFBQ3hCaEUsRUFBRSxlQUFlZ0UsU0FBUyxZQUMxQmhFLEVBQUUsZ0VBQWdFaUUsV0FBVyxZQUdqRixTQUFTRixrQkFDTC9ELEVBQUUsZ0JBQWdCOEMsT0FBTyxTQUFVQyxHQUMvQkEsRUFBRUMsaUJBQ0ZoRCxFQUFFaUQsS0FBSyxpQkFBa0JqRCxFQUFFMEMsTUFBTVEsWUFBYSxTQUFTQyxHQUN2QyxXQUFSQSxFQUNBQyxTQUFTQyxTQUVUQyxNQUFNLDRCQUt0QixTQUFTWSxrQkFDTGxFLDhnQkN4QkosSUFBTW1FLGNBQWdCLENBQ2xCQyxVQUFXLE1BQ1hDLFlBQWEsT0FDYkMsYUFBYyxRQUNkQyxnQkFBaUIsV0FDakJDLGNBQWUsU0FDZkMsV0FBWSxNQUNaQyxlQUFnQixDQUNaQyxLQUFNLFVBQ05DLE1BQU8vRCxZQUVYZ0UsWUFBYSxDQUNURixLQUFNLE9BQ05DLE1BQU8vRCxZQUVYaUUscUJBQXNCLENBQ2xCSCxLQUFNLG1CQUNOQyxNQUFPbEQsZ0JBRVhxRCxhQUFjLENBQ1ZKLEtBQU0sYUFDTkMsTUFBT2xELGlCQUlmLFNBQVNVLGtCQUNMLElBQUk0QyxFQUFVaEYsRUFBRSxhQUFhNkMsT0FDN0I3QyxFQUFFaUYsSUFBSSxnQkFBaUIsQ0FBQ3JCLEtBQU1vQixHQUFVRSxtQkFHNUMsU0FBU0Esa0JBQWtCQyxHQUN2QixJQUQ0QixJQUFBQyxFQUNIQyxPQUFPQyxRQUFRbkIsZUFBeENvQixFQUFBLEVBQUFBLEVBQUFILEVBQUFJLE9BQUFELElBQXdELENBQUEsSUFBQUUsRUFBQUMsZUFBQU4sRUFBQUcsR0FBQSxHQUE3Q0ksRUFBNkNGLEVBQUEsR0FBdkNHLEVBQXVDSCxFQUFBLEdBQ2hESSxPQUFNLEVBQ05ELGFBQWVQLFFBQVVGLEVBQUlTLEVBQUcsWUFBMkJFLElBQWRGLEVBQUloQixRQUNqRGlCLEVBQVNELEVBQUloQixNQUFNTyxFQUFJUyxFQUFHLFFBQzlCNUYsRUFBQyxJQUFBZ0IsT0FBSzJFLElBQU9DLElBQUlDLEdBQVVWLEVBQUlTLElBQVFULEVBQUlTLEVBQUcsT0FBYSxJQUUvRHJGLEVBQUV3RixtQkFDRi9GLEVBQUUsaUJBQWlCVyxLQUFLLFVBQVd3RSxFQUFHLFNDdEMxQyxTQUFTcEYsbUJBQ0xDLEVBQUUsb0JBQW9CZ0csSUFBSSxZQUFhLFFBQ3ZDaEcsRUFBRSxrQkFBa0JnRyxJQUFJLFFBQVMsU0NGckMsU0FBU2pFLFlBQVlrRSxFQUFhQyxHQUM5QixJQUFJQyxFQUFnQixHQW1CaEJuRyxFQUFFb0csVUFBVUMsVUFBVSxTQUFVdEQsR0FDdkIvQyxFQUFFc0csU0FBU0wsRUFBWSxHQUFJakcsRUFBRStDLEVBQUV3RCxRQUFRLEtBQ3hDdkcsRUFBRSxpQkFBaUJ3RyxTQUszQlAsRUFBWVEsU0FBUyxNQUFNbEQsTUFBTSxXQUM3QixJQUFJbUQsRUFBUzFHLEVBQUUwQyxNQUFNL0IsS0FBSyxlQUMxQnVGLEVBQVFRLEdBQVFDLEtBQUtqRSxNQUNyQnVELEVBQVlPLFNBekJwQjlELEtBQUtMLFFBQVUsU0FBU3VFLEdBQ3BCVCxFQUFjVSxLQUFLRCxJQUd2QmxFLEtBQUtGLFFBQVUsU0FBU08sR0FDcEJBLEVBQUVDLGlCQUNGLElBQUEsSUFBQXVDLEVBQUEsRUFBQUEsRUFBaUJZLEVBQWpCWCxPQUFBRCxJQUFBLENBQWlCWSxFQUFKWixHQUF3QnVCLEtBQUtwRSxLQUFWa0UsR0FFaENYLEVBQVljLFNBQVNmLElBQUksQ0FDckJnQixJQUFLakUsRUFBRWtFLE1BQU0sR0FBSyxLQUNsQkMsS0FBTW5FLEVBQUVvRSxNQUFRIiwiZmlsZSI6ImRpc3QuanMiLCJzb3VyY2VzQ29udGVudCI6WyJcclxuZnVuY3Rpb24gYWNjb3VudFNjcmlwdCgpIHtcclxuICAgIHN0eWxlTWF0ZXJpYWxpemUoKTtcclxuICAgICQoJy5kYXRlcGlja2VyJykuZGF0ZXBpY2tlcih7XHJcbiAgICAgICAgY29udGFpbmVyOiAnYm9keSdcclxuICAgIH0pO1xyXG4gICAgcmVnaXN0ZXJBY2NvdW50Q29udGV4dE1lbnUoKTtcclxuICAgIHJlZ2lzdGVyQWRkQWNjKCk7XHJcbiAgICByZWdpc3RlckRlbEFjYygpO1xyXG4gICAgcmVnaXN0ZXJFZGl0QWNjKCk7XHJcbn1cclxuIiwiXHJcbiQoZnVuY3Rpb24oKSB7XHJcbiAgICBNLkF1dG9Jbml0KCk7XHJcbiAgICBsZXQgcm91dGVzID0ge1xyXG4gICAgICAgICdhY2NvdW50U2NyaXB0JzogYWNjb3VudFNjcmlwdFxyXG4gICAgfTtcclxuICAgIGxldCByb3V0ZSA9ICQoJ2JvZHknKS5hdHRyKCdpZCcpO1xyXG5cclxuICAgIGlmKHJvdXRlIGluIHJvdXRlcylcclxuICAgICAgICByb3V0ZXNbcm91dGVdKCk7XHJcbn0pOyIsIlxyXG5jb25zdCBtb250aHMgPSBbJ0phbicsJ0ZlYicsJ01hcicsJ0FwcicsJ01heScsJ0p1bicsJ0p1bCcsJ0F1ZycsJ1NlcCcsJ09jdCcsJ05vdicsJ0RlYyddO1xyXG5cclxuZnVuY3Rpb24gZm9ybWF0RGF0ZShkYXRlKSB7XHJcbiAgICBkYXRlID0gX25vcm1hbGl6ZShkYXRlKTtcclxuICAgIHJldHVybiBgJHttb250aHNbZGF0ZS5nZXRNb250aCgpXX0gJHtkYXRlLmdldERhdGUoKX0sICR7ZGF0ZS5nZXRGdWxsWWVhcigpfWA7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGZvcm1hdFRpbWUoZGF0ZSkge1xyXG4gICAgZGF0ZSA9IF9ub3JtYWxpemUoZGF0ZSk7XHJcbiAgICBsZXQgZm9ybWF0dGVkVGltZSA9ICcnO1xyXG4gICAgZm9ybWF0dGVkVGltZSArPSBkb3VibGVEaWdpdChkYXRlLmdldEhvdXJzKCkpICsgJzonO1xyXG4gICAgZm9ybWF0dGVkVGltZSArPSBkb3VibGVEaWdpdChkYXRlLmdldE1pbnV0ZXMoKSkgKyAnOic7XHJcbiAgICBmb3JtYXR0ZWRUaW1lICs9IGRvdWJsZURpZ2l0KGRhdGUuZ2V0U2Vjb25kcygpKTtcclxuICAgIHJldHVybiBmb3JtYXR0ZWRUaW1lO1xyXG59XHJcblxyXG5mdW5jdGlvbiBmb3JtYXREYXRlVGltZShkYXRlKSB7XHJcbiAgICBkYXRlID0gX25vcm1hbGl6ZShkYXRlKTtcclxuICAgIHJldHVybiBmb3JtYXRUaW1lKGRhdGUpICsgJyAnICsgZm9ybWF0RGF0ZShkYXRlKTtcclxufVxyXG5cclxuZnVuY3Rpb24gX25vcm1hbGl6ZShkYXRlKSB7XHJcbiAgICByZXR1cm4gKGRhdGUgaW5zdGFuY2VvZiBEYXRlKSA/IGRhdGUgOiBuZXcgRGF0ZShkYXRlKTtcclxufVxyXG5cclxuZnVuY3Rpb24gZG91YmxlRGlnaXQobnVtYikge1xyXG4gICAgaWYobnVtYiA8IDEwKVxyXG4gICAgICAgIHJldHVybiAnMCcgKyBudW1iLnRvU3RyaW5nKCk7XHJcbiAgICByZXR1cm4gbnVtYi50b1N0cmluZygpO1xyXG59XHJcbiIsIlxyXG5mdW5jdGlvbiByZWdpc3RlckFjY291bnRDb250ZXh0TWVudSgpIHtcclxuICAgIGxldCBtZW51ID0gbmV3IENvbnRleHRNZW51KCQoJy5jb250ZXh0LW1lbnUnKSwge1xyXG4gICAgICAgICdhZGQnOiAoKSA9PiAkKCcjYWRkLW1vZGFsJykubW9kYWwoJ29wZW4nKSxcclxuICAgICAgICAnZGVsJzogKCkgPT4gJCgnI2RlbC1tb2RhbCcpLm1vZGFsKCdvcGVuJyksXHJcbiAgICAgICAgJ3Nob3cnOiAoKSA9PiB7XHJcbiAgICAgICAgICAgIHVwZGF0ZVNob3dNb2RhbCgpO1xyXG4gICAgICAgICAgICAkKCcjc2hvdy1tb2RhbCcpLm1vZGFsKCdvcGVuJylcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuICAgIG1lbnUuYWRkSG9vayhhZGRTZWxOYW1lKTtcclxuICAgICQoJyNhY2NvdW50cy10YWJsZT50Ym9keT50cicpLmNvbnRleHRtZW51KG1lbnUuaGFuZGxlcik7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGFkZFNlbE5hbWUobWVudSkge1xyXG4gICAgbGV0IHJvd05hbWUgPSAkKHRoaXMpLmZpbmQoJ3RkJykuZmlyc3QoKS5odG1sKCk7XHJcbiAgICAkKCcuc2VsLWl0ZW0nKS5odG1sKHJvd05hbWUpO1xyXG59IiwiZnVuY3Rpb24gcmVnaXN0ZXJBZGRBY2MoKSB7XHJcbiAgICAkKCcjYWRkLWZvcm0nKS5zdWJtaXQoZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgJC5wb3N0KCdhY2NvdW50L2NyZWF0ZScsICQodGhpcykuc2VyaWFsaXplKCksIGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgaWYgKGRhdGEgPT0gJ3N1Y2Nlc3MnKVxyXG4gICAgICAgICAgICAgICAgbG9jYXRpb24ucmVsb2FkKCk7XHJcbiAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgIGFsZXJ0KFwiRXJyb3IgYWRkaW5nIGFjY291bnRcIik7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KVxyXG59XHJcbiIsIlxyXG5mdW5jdGlvbiByZWdpc3RlckRlbEFjYygpIHtcclxuICAgICQoJyNkZWwtYWNjJykuY2xpY2soZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgbGV0IGFjY291bnROYW1lID0gJCgnLnNlbC1pdGVtJykuaHRtbCgpO1xyXG4gICAgICAgICQuYWpheCh7XHJcbiAgICAgICAgICAgICd1cmwnOiAnL2FjY291bnQvZGVsZXRlJyxcclxuICAgICAgICAgICAgJ3R5cGUnOiAnREVMRVRFJyxcclxuICAgICAgICAgICAgJ2RhdGEnOiB7bmFtZTogYWNjb3VudE5hbWV9LFxyXG4gICAgICAgICAgICBzdWNjZXNzOiAoKSA9PiBsb2NhdGlvbi5yZWxvYWQoKVxyXG4gICAgICAgIH0pXHJcbiAgICB9KTtcclxufSIsIlxyXG5mdW5jdGlvbiByZWdpc3RlckVkaXRBY2MoKSB7XHJcbiAgICAkKCcjZWRpdC1idG4nKS5jbGljayhfZWRpdE1vZGUpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBfZWRpdE1vZGUoKSB7XHJcbiAgICBfcmVnaXN0ZXJTdWJtaXQoKTtcclxuICAgICQoJyNlZGl0LWJ0bicpLmFkZENsYXNzKCdzY2FsZS1vdXQnKTtcclxuICAgICQoJyNzdWJtaXQtcm93JykuYWRkQ2xhc3MoJ3NjYWxlLWluJyk7XHJcbiAgICAkKFwiI3VwZGF0ZS1mb3JtIFtkaXNhYmxlZF06bm90KCcjc2hvdy1pZCwgI3Nob3ctc3RhdHVzLWNoYW5nZScpXCIpLnJlbW92ZUF0dHIoJ2Rpc2FibGVkJyk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIF9yZWdpc3RlclN1Ym1pdCgpIHtcclxuICAgICQoJyN1cGRhdGUtZm9ybScpLnN1Ym1pdChmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAkLnBvc3QoJ2FjY291bnQvdXBkYXRlJywgJCh0aGlzKS5zZXJpYWxpemUoKSwgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICBpZiAoZGF0YSA9PSAnc3VjY2VzcycpXHJcbiAgICAgICAgICAgICAgICBsb2NhdGlvbi5yZWxvYWQoKTtcclxuICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAgYWxlcnQoXCJFcnJvciBhZGRpbmcgYWNjb3VudFwiKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBfcmVnaXN0ZXJDYW5jZWwoKSB7XHJcbiAgICAkKClcclxufSIsIlxyXG5jb25zdCBmaWVsZHNNYXBwaW5nID0ge1xyXG4gICAgJ3Nob3ctaWQnOiAnX2lkJyxcclxuICAgICdzaG93LW5hbWUnOiAnbmFtZScsXHJcbiAgICAnc2hvdy1lbWFpbCc6ICdlbWFpbCcsXHJcbiAgICAnc2hvdy1wYXNzd29yZCc6ICdwYXNzd29yZCcsXHJcbiAgICAnc2hvdy1zdGF0dXMnOiAnc3RhdHVzJyxcclxuICAgICdzaG93LXBpbic6ICdwaW4nLFxyXG4gICAgJ3Nob3ctY3JlYXRlZCc6IHtcclxuICAgICAgICBwcm9wOiAnY3JlYXRlZCcsXHJcbiAgICAgICAgcGFyc2U6IGZvcm1hdERhdGVcclxuICAgIH0sXHJcbiAgICAnc2hvdy1tZW1iJzoge1xyXG4gICAgICAgIHByb3A6ICdtZW1iJyxcclxuICAgICAgICBwYXJzZTogZm9ybWF0RGF0ZVxyXG4gICAgfSxcclxuICAgICdzaG93LXN0YXR1cy1jaGFuZ2UnOiB7XHJcbiAgICAgICAgcHJvcDogJ2xhc3RTdGF0dXNDaGFuZ2UnLFxyXG4gICAgICAgIHBhcnNlOiBmb3JtYXREYXRlVGltZVxyXG4gICAgfSxcclxuICAgICdzaG93LWJyZWFrJzoge1xyXG4gICAgICAgIHByb3A6ICdicmVha1VudGlsJyxcclxuICAgICAgICBwYXJzZTogZm9ybWF0RGF0ZVRpbWVcclxuICAgIH1cclxufTtcclxuXHJcbmZ1bmN0aW9uIHVwZGF0ZVNob3dNb2RhbCgpIHtcclxuICAgIGxldCBhY2NOYW1lID0gJCgnLnNlbC1pdGVtJykuaHRtbCgpO1xyXG4gICAgJC5nZXQoJy9hY2NvdW50L3JlYWQnLCB7bmFtZTogYWNjTmFtZX0sIHBvcHVsYXRlU2hvd01vZGFsKTtcclxufVxyXG5cclxuZnVuY3Rpb24gcG9wdWxhdGVTaG93TW9kYWwoYWNjKSB7XHJcbiAgICBmb3IoY29uc3QgW2tleSAsIHZhbF0gb2YgT2JqZWN0LmVudHJpZXMoZmllbGRzTWFwcGluZykpIHtcclxuICAgICAgICBsZXQgbmV3VmFsO1xyXG4gICAgICAgIGlmICh2YWwgaW5zdGFuY2VvZiBPYmplY3QgJiYgYWNjW3ZhbFsncHJvcCddXSAmJiB2YWwucGFyc2UgIT09IHVuZGVmaW5lZClcclxuICAgICAgICAgICAgbmV3VmFsID0gdmFsLnBhcnNlKGFjY1t2YWxbJ3Byb3AnXV0pO1xyXG4gICAgICAgICQoYCMke2tleX1gKS52YWwobmV3VmFsIHx8IGFjY1t2YWxdIHx8IGFjY1t2YWxbJ3Byb3AnXV0gfHwgJycpO1xyXG4gICAgfVxyXG4gICAgTS51cGRhdGVUZXh0RmllbGRzKCk7XHJcbiAgICAkKCcjc2hvdy1zdG9ja2VkJykuYXR0cignY2hlY2tlZCcsIGFjY1snc3RvY2tlZCddKTtcclxufSIsIlxyXG5mdW5jdGlvbiBzdHlsZU1hdGVyaWFsaXplKCkge1xyXG4gICAgJCgnLnNlbGVjdC1kcm9wZG93bicpLmNzcygnZm9udC1zaXplJywgXCIxM3B4XCIpO1xyXG4gICAgJCgnLmRpc3BsYXktZmllbGQnKS5jc3MoJ2NvbG9yJywgJ2JsYWNrJylcclxufSIsIlxyXG5mdW5jdGlvbiBDb250ZXh0TWVudShjb250ZXh0TWVudSwgb3B0aW9ucykge1xyXG4gICAgbGV0IG1lbnVPcGVuSG9va3MgPSBbXTtcclxuICAgIHJlZ2lzdGVyQ2xvc2VIYW5kbGVyKCk7XHJcbiAgICByZWdpc3Rlck9wdGlvbnMoKTtcclxuXHJcbiAgICB0aGlzLmFkZEhvb2sgPSBmdW5jdGlvbihob29rKSB7XHJcbiAgICAgICAgbWVudU9wZW5Ib29rcy5wdXNoKGhvb2spO1xyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLmhhbmRsZXIgPSBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIGZvciAobGV0IGhvb2sgb2YgbWVudU9wZW5Ib29rcykgaG9vay5iaW5kKHRoaXMpKCk7XHJcblxyXG4gICAgICAgIGNvbnRleHRNZW51LnRvZ2dsZSgpLmNzcyh7XHJcbiAgICAgICAgICAgIHRvcDogZS5wYWdlWS0xNSArICdweCcsXHJcbiAgICAgICAgICAgIGxlZnQ6IGUucGFnZVggKyAncHgnXHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgIGZ1bmN0aW9uIHJlZ2lzdGVyQ2xvc2VIYW5kbGVyKCkge1xyXG4gICAgICAgICQoZG9jdW1lbnQpLm1vdXNlZG93bihmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICBpZiAoISQuY29udGFpbnMoY29udGV4dE1lbnVbMF0sICQoZS50YXJnZXQpWzBdKSlcclxuICAgICAgICAgICAgICAgICQoXCIuY29udGV4dC1tZW51XCIpLmhpZGUoKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiByZWdpc3Rlck9wdGlvbnMoKSB7XHJcbiAgICAgICAgY29udGV4dE1lbnUuY2hpbGRyZW4oJ2xpJykuY2xpY2soZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGxldCBhY3Rpb24gPSAkKHRoaXMpLmF0dHIoJ2RhdGEtYWN0aW9uJyk7XHJcbiAgICAgICAgICAgIG9wdGlvbnNbYWN0aW9uXS5jYWxsKHRoaXMpO1xyXG4gICAgICAgICAgICBjb250ZXh0TWVudS5oaWRlKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn1cclxuIl19
