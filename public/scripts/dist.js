"use strict";function accountScript(){styleMaterialize(),$(".datepicker").datepicker({container:"body"}),registerAccountContextMenu(),registerAddAcc(),registerDelAcc(),registerEditAcc()}function loginScript(){$("#login-form").submit(function(t){t.preventDefault(),$.post("/verify-login",$(this).serialize(),function(t){"success"==t&&(window.location.href="../")}).fail(function(){return alert("Unable to authenticate")})})}function ContextMenu(n,e){var o=[];$(document).mousedown(function(t){$.contains(n[0],$(t.target)[0])||$(".context-menu").hide()}),n.children("li").click(function(){var t=$(this).attr("data-action");e[t].call(this),n.hide()}),this.addHook=function(t){o.push(t)},this.handler=function(t){t.preventDefault();for(var e=0;e<o.length;e++){o[e].bind(this)()}n.toggle().css({top:t.pageY-15+"px",left:t.pageX+"px"})}}$(function(){M.AutoInit();var t={accountScript:accountScript,loginScript:loginScript},e=$("body").attr("id");e in t&&t[e]()});var months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function formatDate(t){return t=_normalize(t),"".concat(months[t.getMonth()]," ").concat(t.getDate(),", ").concat(t.getFullYear())}function formatTime(t){var e="";return e+=doubleDigit((t=_normalize(t)).getHours())+":",e+=doubleDigit(t.getMinutes())+":",e+=doubleDigit(t.getSeconds())}function formatDateTime(t){return formatTime(t=_normalize(t))+" "+formatDate(t)}function _normalize(t){return t instanceof Date?t:new Date(t)}function doubleDigit(t){return t<10?"0"+t.toString():t.toString()}function styleMaterialize(){$(".select-dropdown").css("font-size","13px"),$(".display-field").css("color","black")}function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(t,e){var n=[],o=!0,r=!1,a=void 0;try{for(var i,c=t[Symbol.iterator]();!(o=(i=c.next()).done)&&(n.push(i.value),!e||n.length!==e);o=!0);}catch(t){r=!0,a=t}finally{try{o||null==c.return||c.return()}finally{if(r)throw a}}return n}function _arrayWithHoles(t){if(Array.isArray(t))return t}function clean(t){for(var e=Object.entries(t),n=0;n<e.length;n++){var o=_slicedToArray(e[n],2),r=o[0],a=o[1];console.log(a),""!=a&&null!=a&&null!=a||delete t[r]}console.log(t)}function registerAccountContextMenu(){var t=new ContextMenu($(".context-menu"),{add:function(){return $("#add-modal").modal("open")},del:function(){return $("#del-modal").modal("open")},show:function(){updateShowModal(),$("#show-modal").modal("open")}});t.addHook(addSelName),$("#accounts-table>tbody>tr").contextmenu(t.handler)}function addSelName(t){var e=$(this).find("td").first().html();$(".sel-item").html(e)}function registerAddAcc(){$("#add-form").submit(function(t){t.preventDefault(),$.post("account/create",$(this).serialize(),function(t){"success"==t?location.reload():alert("Error adding account")})})}function registerDelAcc(){$("#del-acc").click(function(){var t=$(".sel-item").html();$.ajax({url:"/account/delete",type:"DELETE",data:{name:t},success:function(){return location.reload()}})})}function registerEditAcc(){$("#edit-btn").click(_editMode),_registerOnClose()}function _editMode(){_registerSubmit(),$("#edit-btn").addClass("scale-out"),$("#submit-row").addClass("scale-in"),$("#update-form [disabled]:not('#show-id, #show-status-change')").removeAttr("disabled")}function _registerSubmit(){$("#update-form").submit(function(t){t.preventDefault(),$(this).serialize(),$.ajax({type:"PUT",url:"account/update/".concat($("#show-id").val()),data:$(this).serialize(),success:function(t){"success"==t?location.reload():alert("Error updating account")}})})}function _registerCancel(){}function _registerOnClose(){console.log("Registering close"),$("#show-modal").modal({dismissible:!0,complete:function(){alert("closed")}})}function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(t,e){var n=[],o=!0,r=!1,a=void 0;try{for(var i,c=t[Symbol.iterator]();!(o=(i=c.next()).done)&&(n.push(i.value),!e||n.length!==e);o=!0);}catch(t){r=!0,a=t}finally{try{o||null==c.return||c.return()}finally{if(r)throw a}}return n}function _arrayWithHoles(t){if(Array.isArray(t))return t}var fieldsMapping={"show-id":"_id","show-name":"name","show-email":"email","show-password":"password","show-status":"status","show-pin":"pin","show-created":{prop:"created",parse:formatDate},"show-memb":{prop:"memb",parse:formatDate},"show-status-change":{prop:"lastStatusChange",parse:formatDateTime},"show-break":{prop:"breakUntil",parse:formatDateTime}};function updateShowModal(){var t=$(".sel-item").html();$.get("/account/read",{name:t},populateShowModal)}function populateShowModal(t){for(var e=Object.entries(fieldsMapping),n=0;n<e.length;n++){var o=_slicedToArray(e[n],2),r=o[0],a=o[1],i=void 0;a instanceof Object&&t[a.prop]&&void 0!==a.parse&&(i=a.parse(t[a.prop])),$("#".concat(r)).val(i||t[a]||t[a.prop]||"")}M.updateTextFields(),$("#show-stocked").attr("checked",t.stocked)}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFjY291bnQtc2NyaXB0LmpzIiwibG9naW4tc2NyaXB0LmpzIiwiY29udGV4dG1lbnVzL2NvbnRleHRtZW51LmpzIiwibWFpbi5qcyIsInBhcnNlcnMvZGF0ZS5qcyIsInN0eWxlcnMvbWF0ZXJpYWxpemUuanMiLCJ1dGlscy9vYmouanMiLCJyZWdpc3RlcnMvYWNjb3VudC9hY2MtY29udGV4dG1lbnUuanMiLCJyZWdpc3RlcnMvYWNjb3VudC9hZGQtYWNjLmpzIiwicmVnaXN0ZXJzL2FjY291bnQvZGVsLWFjYy5qcyIsInJlZ2lzdGVycy9hY2NvdW50L2VkaXQtYWNjLmpzIiwicmVnaXN0ZXJzL2FjY291bnQvc2hvdy1hY2MuanMiXSwibmFtZXMiOlsiYWNjb3VudFNjcmlwdCIsInN0eWxlTWF0ZXJpYWxpemUiLCIkIiwiZGF0ZXBpY2tlciIsImNvbnRhaW5lciIsInJlZ2lzdGVyQWNjb3VudENvbnRleHRNZW51IiwicmVnaXN0ZXJBZGRBY2MiLCJyZWdpc3RlckRlbEFjYyIsInJlZ2lzdGVyRWRpdEFjYyIsImxvZ2luU2NyaXB0Iiwic3VibWl0IiwiZSIsInByZXZlbnREZWZhdWx0IiwicG9zdCIsInRoaXMiLCJzZXJpYWxpemUiLCJyZXMiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsImhyZWYiLCJmYWlsIiwiYWxlcnQiLCJDb250ZXh0TWVudSIsImNvbnRleHRNZW51Iiwib3B0aW9ucyIsIm1lbnVPcGVuSG9va3MiLCJkb2N1bWVudCIsIm1vdXNlZG93biIsImNvbnRhaW5zIiwidGFyZ2V0IiwiaGlkZSIsImNoaWxkcmVuIiwiY2xpY2siLCJhY3Rpb24iLCJhdHRyIiwiY2FsbCIsImFkZEhvb2siLCJob29rIiwicHVzaCIsImhhbmRsZXIiLCJfaSIsImxlbmd0aCIsImJpbmQiLCJ0b2dnbGUiLCJjc3MiLCJ0b3AiLCJwYWdlWSIsImxlZnQiLCJwYWdlWCIsIk0iLCJBdXRvSW5pdCIsInJvdXRlcyIsInJvdXRlIiwibW9udGhzIiwiZm9ybWF0RGF0ZSIsImRhdGUiLCJfbm9ybWFsaXplIiwiY29uY2F0IiwiZ2V0TW9udGgiLCJnZXREYXRlIiwiZ2V0RnVsbFllYXIiLCJmb3JtYXRUaW1lIiwiZm9ybWF0dGVkVGltZSIsImRvdWJsZURpZ2l0IiwiZ2V0SG91cnMiLCJnZXRNaW51dGVzIiwiZ2V0U2Vjb25kcyIsImZvcm1hdERhdGVUaW1lIiwiRGF0ZSIsIm51bWIiLCJ0b1N0cmluZyIsImNsZWFuIiwib2JqIiwiX2FyciIsIk9iamVjdCIsImVudHJpZXMiLCJfYXJyJF9pIiwiX3NsaWNlZFRvQXJyYXkiLCJrZXkiLCJ2YWwiLCJjb25zb2xlIiwibG9nIiwidW5kZWZpbmVkIiwibWVudSIsImFkZCIsIm1vZGFsIiwiZGVsIiwic2hvdyIsInVwZGF0ZVNob3dNb2RhbCIsImFkZFNlbE5hbWUiLCJjb250ZXh0bWVudSIsInJvd05hbWUiLCJmaW5kIiwiZmlyc3QiLCJodG1sIiwiZGF0YSIsInJlbG9hZCIsImFjY291bnROYW1lIiwiYWpheCIsInVybCIsInR5cGUiLCJuYW1lIiwic3VjY2VzcyIsIl9lZGl0TW9kZSIsIl9yZWdpc3Rlck9uQ2xvc2UiLCJfcmVnaXN0ZXJTdWJtaXQiLCJhZGRDbGFzcyIsInJlbW92ZUF0dHIiLCJfcmVnaXN0ZXJDYW5jZWwiLCJkaXNtaXNzaWJsZSIsImNvbXBsZXRlIiwiZmllbGRzTWFwcGluZyIsInNob3ctaWQiLCJzaG93LW5hbWUiLCJzaG93LWVtYWlsIiwic2hvdy1wYXNzd29yZCIsInNob3ctc3RhdHVzIiwic2hvdy1waW4iLCJzaG93LWNyZWF0ZWQiLCJwcm9wIiwicGFyc2UiLCJzaG93LW1lbWIiLCJzaG93LXN0YXR1cy1jaGFuZ2UiLCJzaG93LWJyZWFrIiwiYWNjTmFtZSIsImdldCIsInBvcHVsYXRlU2hvd01vZGFsIiwiYWNjIiwibmV3VmFsIiwidXBkYXRlVGV4dEZpZWxkcyJdLCJtYXBwaW5ncyI6ImFBQ0EsU0FBU0EsZ0JBQ0xDLG1CQUNBQyxFQUFFLGVBQWVDLFdBQVcsQ0FDeEJDLFVBQVcsU0FFZkMsNkJBQ0FD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Y2NvdW50U2NyaXB0KCkge1xyXG4gICAgc3R5bGVNYXRlcmlhbGl6ZSgpO1xyXG4gICAgJCgnLmRhdGVwaWNrZXInKS5kYXRlcGlja2VyKHtcclxuICAgICAgICBjb250YWluZXI6ICdib2R5J1xyXG4gICAgfSk7XHJcbiAgICByZWdpc3RlckFjY291bnRDb250ZXh0TWVudSgpO1xyXG4gICAgcmVnaXN0ZXJBZGRBY2MoKTtcclxuICAgIHJlZ2lzdGVyRGVsQWNjKCk7XHJcbiAgICByZWdpc3RlckVkaXRBY2MoKTtcclxufVxyXG4iLCJcclxuZnVuY3Rpb24gbG9naW5TY3JpcHQoKSB7XHJcbiAgICAkKCcjbG9naW4tZm9ybScpLnN1Ym1pdChmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICQucG9zdCgnL3ZlcmlmeS1sb2dpbicsICQodGhpcykuc2VyaWFsaXplKCksIGZ1bmN0aW9uKHJlcykge1xyXG4gICAgICAgICAgICBpZiAocmVzID09ICdzdWNjZXNzJylcclxuICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gJy4uLyc7XHJcbiAgICAgICAgfSkuZmFpbCgoKSA9PiBhbGVydChcIlVuYWJsZSB0byBhdXRoZW50aWNhdGVcIikpO1xyXG4gICAgfSlcclxufVxyXG5cclxuIiwiXHJcbmZ1bmN0aW9uIENvbnRleHRNZW51KGNvbnRleHRNZW51LCBvcHRpb25zKSB7XHJcbiAgICBsZXQgbWVudU9wZW5Ib29rcyA9IFtdO1xyXG4gICAgcmVnaXN0ZXJDbG9zZUhhbmRsZXIoKTtcclxuICAgIHJlZ2lzdGVyT3B0aW9ucygpO1xyXG5cclxuICAgIHRoaXMuYWRkSG9vayA9IGZ1bmN0aW9uKGhvb2spIHtcclxuICAgICAgICBtZW51T3Blbkhvb2tzLnB1c2goaG9vayk7XHJcbiAgICB9O1xyXG5cclxuICAgIHRoaXMuaGFuZGxlciA9IGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgZm9yIChsZXQgaG9vayBvZiBtZW51T3Blbkhvb2tzKSBob29rLmJpbmQodGhpcykoKTtcclxuXHJcbiAgICAgICAgY29udGV4dE1lbnUudG9nZ2xlKCkuY3NzKHtcclxuICAgICAgICAgICAgdG9wOiBlLnBhZ2VZLTE1ICsgJ3B4JyxcclxuICAgICAgICAgICAgbGVmdDogZS5wYWdlWCArICdweCdcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcblxyXG4gICAgZnVuY3Rpb24gcmVnaXN0ZXJDbG9zZUhhbmRsZXIoKSB7XHJcbiAgICAgICAgJChkb2N1bWVudCkubW91c2Vkb3duKGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgICAgIGlmICghJC5jb250YWlucyhjb250ZXh0TWVudVswXSwgJChlLnRhcmdldClbMF0pKVxyXG4gICAgICAgICAgICAgICAgJChcIi5jb250ZXh0LW1lbnVcIikuaGlkZSgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHJlZ2lzdGVyT3B0aW9ucygpIHtcclxuICAgICAgICBjb250ZXh0TWVudS5jaGlsZHJlbignbGknKS5jbGljayhmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgbGV0IGFjdGlvbiA9ICQodGhpcykuYXR0cignZGF0YS1hY3Rpb24nKTtcclxuICAgICAgICAgICAgb3B0aW9uc1thY3Rpb25dLmNhbGwodGhpcyk7XHJcbiAgICAgICAgICAgIGNvbnRleHRNZW51LmhpZGUoKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxufVxyXG4iLCJcclxuJChmdW5jdGlvbigpIHtcclxuICAgIE0uQXV0b0luaXQoKTtcclxuICAgIGxldCByb3V0ZXMgPSB7XHJcbiAgICAgICAgJ2FjY291bnRTY3JpcHQnOiBhY2NvdW50U2NyaXB0LFxyXG4gICAgICAgICdsb2dpblNjcmlwdCc6IGxvZ2luU2NyaXB0XHJcbiAgICB9O1xyXG4gICAgbGV0IHJvdXRlID0gJCgnYm9keScpLmF0dHIoJ2lkJyk7XHJcblxyXG4gICAgaWYocm91dGUgaW4gcm91dGVzKVxyXG4gICAgICAgIHJvdXRlc1tyb3V0ZV0oKTtcclxufSk7XHJcblxyXG4iLCJcclxuY29uc3QgbW9udGhzID0gWydKYW4nLCdGZWInLCdNYXInLCdBcHInLCdNYXknLCdKdW4nLCdKdWwnLCdBdWcnLCdTZXAnLCdPY3QnLCdOb3YnLCdEZWMnXTtcclxuXHJcbmZ1bmN0aW9uIGZvcm1hdERhdGUoZGF0ZSkge1xyXG4gICAgZGF0ZSA9IF9ub3JtYWxpemUoZGF0ZSk7XHJcbiAgICByZXR1cm4gYCR7bW9udGhzW2RhdGUuZ2V0TW9udGgoKV19ICR7ZGF0ZS5nZXREYXRlKCl9LCAke2RhdGUuZ2V0RnVsbFllYXIoKX1gO1xyXG59XHJcblxyXG5mdW5jdGlvbiBmb3JtYXRUaW1lKGRhdGUpIHtcclxuICAgIGRhdGUgPSBfbm9ybWFsaXplKGRhdGUpO1xyXG4gICAgbGV0IGZvcm1hdHRlZFRpbWUgPSAnJztcclxuICAgIGZvcm1hdHRlZFRpbWUgKz0gZG91YmxlRGlnaXQoZGF0ZS5nZXRIb3VycygpKSArICc6JztcclxuICAgIGZvcm1hdHRlZFRpbWUgKz0gZG91YmxlRGlnaXQoZGF0ZS5nZXRNaW51dGVzKCkpICsgJzonO1xyXG4gICAgZm9ybWF0dGVkVGltZSArPSBkb3VibGVEaWdpdChkYXRlLmdldFNlY29uZHMoKSk7XHJcbiAgICByZXR1cm4gZm9ybWF0dGVkVGltZTtcclxufVxyXG5cclxuZnVuY3Rpb24gZm9ybWF0RGF0ZVRpbWUoZGF0ZSkge1xyXG4gICAgZGF0ZSA9IF9ub3JtYWxpemUoZGF0ZSk7XHJcbiAgICByZXR1cm4gZm9ybWF0VGltZShkYXRlKSArICcgJyArIGZvcm1hdERhdGUoZGF0ZSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIF9ub3JtYWxpemUoZGF0ZSkge1xyXG4gICAgcmV0dXJuIChkYXRlIGluc3RhbmNlb2YgRGF0ZSkgPyBkYXRlIDogbmV3IERhdGUoZGF0ZSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGRvdWJsZURpZ2l0KG51bWIpIHtcclxuICAgIGlmKG51bWIgPCAxMClcclxuICAgICAgICByZXR1cm4gJzAnICsgbnVtYi50b1N0cmluZygpO1xyXG4gICAgcmV0dXJuIG51bWIudG9TdHJpbmcoKTtcclxufVxyXG4iLCJcclxuZnVuY3Rpb24gc3R5bGVNYXRlcmlhbGl6ZSgpIHtcclxuICAgICQoJy5zZWxlY3QtZHJvcGRvd24nKS5jc3MoJ2ZvbnQtc2l6ZScsIFwiMTNweFwiKTtcclxuICAgICQoJy5kaXNwbGF5LWZpZWxkJykuY3NzKCdjb2xvcicsICdibGFjaycpXHJcbn0iLCJcclxuZnVuY3Rpb24gY2xlYW4ob2JqKSB7XHJcbiAgICBmb3IobGV0IFtrZXksIHZhbF0gb2YgT2JqZWN0LmVudHJpZXMob2JqKSkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKHZhbCk7XHJcbiAgICAgICAgaWYgKHZhbCA9PSAnJyB8fCB2YWwgPT0gdW5kZWZpbmVkIHx8IHZhbCA9PSBudWxsKVxyXG4gICAgICAgICAgICBkZWxldGUgb2JqW2tleV1cclxuICAgIH1cclxuICAgIGNvbnNvbGUubG9nKG9iaik7XHJcbn0iLCJcclxuZnVuY3Rpb24gcmVnaXN0ZXJBY2NvdW50Q29udGV4dE1lbnUoKSB7XHJcbiAgICBsZXQgbWVudSA9IG5ldyBDb250ZXh0TWVudSgkKCcuY29udGV4dC1tZW51JyksIHtcclxuICAgICAgICAnYWRkJzogKCkgPT4gJCgnI2FkZC1tb2RhbCcpLm1vZGFsKCdvcGVuJyksXHJcbiAgICAgICAgJ2RlbCc6ICgpID0+ICQoJyNkZWwtbW9kYWwnKS5tb2RhbCgnb3BlbicpLFxyXG4gICAgICAgICdzaG93JzogKCkgPT4ge1xyXG4gICAgICAgICAgICB1cGRhdGVTaG93TW9kYWwoKTtcclxuICAgICAgICAgICAgJCgnI3Nob3ctbW9kYWwnKS5tb2RhbCgnb3BlbicpXHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICBtZW51LmFkZEhvb2soYWRkU2VsTmFtZSk7XHJcbiAgICAkKCcjYWNjb3VudHMtdGFibGU+dGJvZHk+dHInKS5jb250ZXh0bWVudShtZW51LmhhbmRsZXIpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBhZGRTZWxOYW1lKG1lbnUpIHtcclxuICAgIGxldCByb3dOYW1lID0gJCh0aGlzKS5maW5kKCd0ZCcpLmZpcnN0KCkuaHRtbCgpO1xyXG4gICAgJCgnLnNlbC1pdGVtJykuaHRtbChyb3dOYW1lKTtcclxufSIsImZ1bmN0aW9uIHJlZ2lzdGVyQWRkQWNjKCkge1xyXG4gICAgJCgnI2FkZC1mb3JtJykuc3VibWl0KGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICQucG9zdCgnYWNjb3VudC9jcmVhdGUnLCAkKHRoaXMpLnNlcmlhbGl6ZSgpLCBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIGlmIChkYXRhID09ICdzdWNjZXNzJylcclxuICAgICAgICAgICAgICAgIGxvY2F0aW9uLnJlbG9hZCgpO1xyXG4gICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICBhbGVydChcIkVycm9yIGFkZGluZyBhY2NvdW50XCIpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSlcclxufVxyXG4iLCJcclxuZnVuY3Rpb24gcmVnaXN0ZXJEZWxBY2MoKSB7XHJcbiAgICAkKCcjZGVsLWFjYycpLmNsaWNrKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGxldCBhY2NvdW50TmFtZSA9ICQoJy5zZWwtaXRlbScpLmh0bWwoKTtcclxuICAgICAgICAkLmFqYXgoe1xyXG4gICAgICAgICAgICAndXJsJzogJy9hY2NvdW50L2RlbGV0ZScsXHJcbiAgICAgICAgICAgICd0eXBlJzogJ0RFTEVURScsXHJcbiAgICAgICAgICAgICdkYXRhJzoge25hbWU6IGFjY291bnROYW1lfSxcclxuICAgICAgICAgICAgc3VjY2VzczogKCkgPT4gbG9jYXRpb24ucmVsb2FkKClcclxuICAgICAgICB9KVxyXG4gICAgfSk7XHJcbn0iLCJcclxuZnVuY3Rpb24gcmVnaXN0ZXJFZGl0QWNjKCkge1xyXG4gICAgJCgnI2VkaXQtYnRuJykuY2xpY2soX2VkaXRNb2RlKTtcclxuICAgIF9yZWdpc3Rlck9uQ2xvc2UoKTtcclxufVxyXG5cclxuZnVuY3Rpb24gX2VkaXRNb2RlKCkge1xyXG4gICAgX3JlZ2lzdGVyU3VibWl0KCk7XHJcblxyXG4gICAgJCgnI2VkaXQtYnRuJykuYWRkQ2xhc3MoJ3NjYWxlLW91dCcpO1xyXG4gICAgJCgnI3N1Ym1pdC1yb3cnKS5hZGRDbGFzcygnc2NhbGUtaW4nKTtcclxuICAgICQoXCIjdXBkYXRlLWZvcm0gW2Rpc2FibGVkXTpub3QoJyNzaG93LWlkLCAjc2hvdy1zdGF0dXMtY2hhbmdlJylcIikucmVtb3ZlQXR0cignZGlzYWJsZWQnKTtcclxufVxyXG5cclxuZnVuY3Rpb24gX3JlZ2lzdGVyU3VibWl0KCkge1xyXG4gICAgJCgnI3VwZGF0ZS1mb3JtJykuc3VibWl0KGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICQodGhpcykuc2VyaWFsaXplKCk7XHJcbiAgICAgICAgJC5hamF4KHtcclxuICAgICAgICAgICAgdHlwZTogJ1BVVCcsXHJcbiAgICAgICAgICAgIHVybDogYGFjY291bnQvdXBkYXRlLyR7JCgnI3Nob3ctaWQnKS52YWwoKX1gLFxyXG4gICAgICAgICAgICBkYXRhOiAkKHRoaXMpLnNlcmlhbGl6ZSgpLFxyXG4gICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZGF0YSA9PSAnc3VjY2VzcycpXHJcbiAgICAgICAgICAgICAgICAgICAgbG9jYXRpb24ucmVsb2FkKCk7XHJcbiAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgYWxlcnQoXCJFcnJvciB1cGRhdGluZyBhY2NvdW50XCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gX3JlZ2lzdGVyQ2FuY2VsKCkge1xyXG5cclxufVxyXG5cclxuZnVuY3Rpb24gX3JlZ2lzdGVyT25DbG9zZSgpIHtcclxuICAgIGNvbnNvbGUubG9nKFwiUmVnaXN0ZXJpbmcgY2xvc2VcIik7XHJcbiAgICAkKCcjc2hvdy1tb2RhbCcpLm1vZGFsKHtcclxuICAgICAgICBkaXNtaXNzaWJsZTogdHJ1ZSxcclxuICAgICAgICBjb21wbGV0ZTogZnVuY3Rpb24oKSB7YWxlcnQoJ2Nsb3NlZCcpfVxyXG4gICAgfSk7XHJcbn0iLCJcclxuY29uc3QgZmllbGRzTWFwcGluZyA9IHtcclxuICAgICdzaG93LWlkJzogJ19pZCcsXHJcbiAgICAnc2hvdy1uYW1lJzogJ25hbWUnLFxyXG4gICAgJ3Nob3ctZW1haWwnOiAnZW1haWwnLFxyXG4gICAgJ3Nob3ctcGFzc3dvcmQnOiAncGFzc3dvcmQnLFxyXG4gICAgJ3Nob3ctc3RhdHVzJzogJ3N0YXR1cycsXHJcbiAgICAnc2hvdy1waW4nOiAncGluJyxcclxuICAgICdzaG93LWNyZWF0ZWQnOiB7XHJcbiAgICAgICAgcHJvcDogJ2NyZWF0ZWQnLFxyXG4gICAgICAgIHBhcnNlOiBmb3JtYXREYXRlXHJcbiAgICB9LFxyXG4gICAgJ3Nob3ctbWVtYic6IHtcclxuICAgICAgICBwcm9wOiAnbWVtYicsXHJcbiAgICAgICAgcGFyc2U6IGZvcm1hdERhdGVcclxuICAgIH0sXHJcbiAgICAnc2hvdy1zdGF0dXMtY2hhbmdlJzoge1xyXG4gICAgICAgIHByb3A6ICdsYXN0U3RhdHVzQ2hhbmdlJyxcclxuICAgICAgICBwYXJzZTogZm9ybWF0RGF0ZVRpbWVcclxuICAgIH0sXHJcbiAgICAnc2hvdy1icmVhayc6IHtcclxuICAgICAgICBwcm9wOiAnYnJlYWtVbnRpbCcsXHJcbiAgICAgICAgcGFyc2U6IGZvcm1hdERhdGVUaW1lXHJcbiAgICB9XHJcbn07XHJcblxyXG5mdW5jdGlvbiB1cGRhdGVTaG93TW9kYWwoKSB7XHJcbiAgICBsZXQgYWNjTmFtZSA9ICQoJy5zZWwtaXRlbScpLmh0bWwoKTtcclxuICAgICQuZ2V0KCcvYWNjb3VudC9yZWFkJywge25hbWU6IGFjY05hbWV9LCBwb3B1bGF0ZVNob3dNb2RhbCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHBvcHVsYXRlU2hvd01vZGFsKGFjYykge1xyXG4gICAgZm9yKGNvbnN0IFtrZXkgLCB2YWxdIG9mIE9iamVjdC5lbnRyaWVzKGZpZWxkc01hcHBpbmcpKSB7XHJcbiAgICAgICAgbGV0IG5ld1ZhbDtcclxuICAgICAgICBpZiAodmFsIGluc3RhbmNlb2YgT2JqZWN0ICYmIGFjY1t2YWxbJ3Byb3AnXV0gJiYgdmFsLnBhcnNlICE9PSB1bmRlZmluZWQpXHJcbiAgICAgICAgICAgIG5ld1ZhbCA9IHZhbC5wYXJzZShhY2NbdmFsWydwcm9wJ11dKTtcclxuICAgICAgICAkKGAjJHtrZXl9YCkudmFsKG5ld1ZhbCB8fCBhY2NbdmFsXSB8fCBhY2NbdmFsWydwcm9wJ11dIHx8ICcnKTtcclxuICAgIH1cclxuICAgIE0udXBkYXRlVGV4dEZpZWxkcygpO1xyXG4gICAgJCgnI3Nob3ctc3RvY2tlZCcpLmF0dHIoJ2NoZWNrZWQnLCBhY2NbJ3N0b2NrZWQnXSk7XHJcbn0iXX0=
